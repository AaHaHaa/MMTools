% This code arranges the data required for Judd-Ofelt analysis.
% The data is from:
%
% 1. Carnall et al., "Energy level structure and transition probabilities 
%    in the spectra of the trivalent lanthanides in LaF_3," (1978)
% 2. Alexander A. Kaminskii, "Laser Crystals: Their Physics and
%    Properties," Springer Berlin Heidelberg (2014)

clearvars; close all;

% State
layere = {'2D5/2';'2P1/2';'2K15/2';'4G11/2';'2D3/2';'2K13/2';'4G9/2';'4G7/2';'2G7/2';'4G5/2';'2H11/2';'4F9/2';'4S3/2';'4F7/2';'2H9/2';'4F5/2';'4F3/2';'4I15/2';'4I13/2';'4I11/2';'4I9/2'};
energy = [  24004;  23458;   21780;   21714;  21425;   19785;  19709;  19293;  17469;  17428;   16105;  14899;  13691;  13619;  12768;  12660;  11621;    6148;    4098;    2114;    235];
num =    [      6;      2;      16;      12;      4;      14;     10;      8;      8;      6;      12;     10;      4;      8;     10;      6;      4;      16;      14;      12;     10]; % 2*J+1

% Transition to the ground state
layerM = { '2D5/2-4I9/2';...
           '2P1/2-4I9/2';...
          '2K15/2-4I9/2';...
          '4G11/2-4I9/2';...
           '2D3/2-4I9/2';...
          '2K13/2-4I9/2';...
           '4G9/2-4I9/2';...
           '4G7/2-4I9/2';...
           '2G7/2-4I9/2';...
           '4G5/2-4I9/2';...
          '2H11/2-4I9/2';...
           '4F9/2-4I9/2';...
           '4S3/2-4I9/2';...
           '4F7/2-4I9/2';...
           '2H9/2-4I9/2';...
           '4F5/2-4I9/2';...
           '4F3/2-4I9/2';...
          '4I15/2-4I9/2';...
          '4I13/2-4I9/2';...
          '4I11/2-4I9/2'};
raree = [0.0001000, 0.0002000, 0.0021000;... %  2D5/2
         0.0000000, 0.0367000, 0.0000000;... %  2P1/2
         0.0000000, 0.0052000, 0.0143000;... % 2K15/2
         0.0000000, 0.0053000, 0.0080000;... % 4G11/2
         0.0000000, 0.0188000, 0.0002000;... %  2D3/2
         0.0069000, 0.0002000, 0.0312000;... % 2K13/2
         0.0046000, 0.0608000, 0.0406000;... %  4G9/2
         0.0551829, 0.1575348, 0.0553452;... %  4G7/2
         0.0756687, 0.1848501, 0.0313910;... %  2G7/2
         0.8978513, 0.4092854, 0.0358914;... %  4G5/2
         0.0000557, 0.0026723, 0.0103605;... % 2H11/2
         0.0008714, 0.0092309, 0.0416621;... %  4F9/2
         0.0009864, 0.0422939, 0.4244894;... %  4S3/2
         0.0000000, 0.0026944, 0.2352404;... %  4F7/2
         0.0092243, 0.0079976, 0.1154513;... %  2H9/2
         0.0009659, 0.2370999, 0.3970185;... %  4F5/2
         0.0000000, 0.2293435, 0.0548707;... %  4F3/2
         0.0000000, 0.0000637, 0.0452683;... % 4I15/2
         0.0000662, 0.0135702, 0.4556863;... % 4I13/2
         0.0194432, 0.1073318, 1.1649272];   % 4I11/2

% Transition among states
layer = {'2D5/2-2P1/2';...  % [0.0260, 0, 0]
         '2D5/2-2K15/2';... % [0, 0, 0.4889]
         '2D5/2-4G11/2';... % [0, 0.0314, 0.0006]
         '2D5/2-2D3/2';... % [0.1744, 0.0011, 0]
         '2D5/2-2K13/2';... % [0, 0.0033, 0.1828]
         '2D5/2-4G9/2';... % [0, 0.0077, 0.0064]
         '2D5/2-4G7/2';... % [0.0003, 0.0481, 0.0558]
         '2D5/2-2G7/2';... % [0.0064, 0.0688, 0.1756]
         '2D5/2-4G5/2';... % [0.0014, 0.0008, 0]
         '2D5/2-2H11/2';... % [0, 0.2523, 0.0184]
         '2D5/2-4F9/2';... % [0.0003, 0.0110, 0.0132]
         '2D5/2-4S3/2';... % [0.0071, 0, 0]
         '2D5/2-4F7/2';... % [0.0005, 0.0171, 0.0064]
         '2D5/2-2H9/2';... % [0.0078, 0.1994, 0.0791]
         '2D5/2-4F5/2';... % [0.0005, 0.0006, 0]
         '2D5/2-4F3/2';... % [0.0009, 0.0007, 0]
         '2D5/2-4I15/2';...
         '2D5/2-4I13/2';... % [0, 0.0037, 0.0169]
         '2D5/2-4I11/2';... % [0, 0.0001, 0.0029]
         '2D5/2-4I9/2';... % [0, 0.0002, 0.0017]
         
         '2P1/2-2K15/2';...
         '2P1/2-4G11/2';...
         '2P1/2-2D3/2';... % [0.0291, 0, 0]
         '2P1/2-2K13/2';...
         '2P1/2-4G9/2';... % [0, 0.0010, 0]
         '2P1/2-4G7/2';... % [0, 0.0026, 0]
         '2P1/2-2G7/2';... % [0, 0.0097, 0]
         '2P1/2-4G5/2';... % [0.0346, 0, 0]
         '2P1/2-2H11/2';...
         '2P1/2-4F9/2';... % [0, 0.0033, 0]
         '2P1/2-4S3/2';... % [0.0175, 0, 0]
         '2P1/2-4F7/2';... % [0, 0.0200, 0]
         '2P1/2-2H9/2';... % [0, 0.0871, 0]
         '2P1/2-4F5/2';... % [0.0101, 0, 0]
         '2P1/2-4F3/2';... % [0.0131, 0, 0]
         '2P1/2-4I15/2';...
         '2P1/2-4I13/2';... % [0, 0, 0.1746]
         '2P1/2-4I11/2';... % [0, 0, 0.1643]
         '2P1/2-4I9/2';... % [0, 0.0396, 0]
         
         '2K15/2-4G11/2';... % [0.0099, 0.0162, 0.0912]
         '2K15/2-2D3/2';... % [0, 0, 0.3482]
         '2K15/2-2K13/2';...
         '2K15/2-4G9/2';... % [0, 0.1408, 0.0246]
         '2K15/2-4G7/2';... % [0, 0.0186, 0.0018]
         '2K15/2-2G7/2';... % [0, 0.0383, 0.0122]
         '2K15/2-4G5/2';... % [0, 0, 0.0051]
         '2K15/2-2H11/2';... % [0.1556, 0.0017, 1.5224]
         '2K15/2-4F9/2';... % [0, 0.0003, 0.2037]
         '2K15/2-4S3/2';... % [0, 0, 0.0030]
         '2K15/2-4F7/2';... % [0, 0, 0.0077]
         '2K15/2-2H9/2';... % [0, 0.4675, 0.4145]
         '2K15/2-4F5/2';... % [0, 0, 0.0051]
         '2K15/2-4F3/2';... % [0, 0, 0.0099]
         '2K15/2-4I15/2';...
         '2K15/2-4I13/2';...
         '2K15/2-4I11/2';... % [0.0020, 0.0003, 0.0039]
         '2K15/2-4I9/2';... % [0, 0.0052, 0.0149]
         
         '4G11/2-2D3/2';... % [0, 0.0300, 0.0003]
         '4G11/2-2K13/2';... % [0.0001, 0.0077, 0.0233]
         '4G11/2-4G9/2';... % [0.0521, 0.5102, 0.1206]
         '4G11/2-4G7/2';... % [0.0023, 0.0341, 0.3811]
         '4G11/2-2G7/2';... % [0.0119, 0.1233, 0.0015]
         '4G11/2-4G5/2';... % [0, 0.0094, 0.0914]
         '4G11/2-2H11/2';... % [0.0009, 0.0809, 0.0109]
         '4G11/2-4F9/2';... % [0.9423, 0.2060, 0.0411]
         '4G11/2-4S3/2';... % [0, 0.3245, 0.0004]
         '4G11/2-4F7/2';... % [0.1729, 0.1623, 0.1447]
         '4G11/2-2H9/2';... % [0.1796, 0.0001, 0.0037]
         '4G11/2-4F5/2';... % [0, 0.0611, 0.1976]
         '4G11/2-4F3/2';... % [0, 0.0015, 0.0992]
         '4G11/2-4I15/2';... % [1.5301, 0.8915, 0.1590]
         '4G11/2-4I13/2';... % [0.1283, 0.3514, 0.1609]
         '4G11/2-4I11/2';... % [0.0044, 0.0645, 0.0563]
         '4G11/2-4I9/2';... % [0, 0.0052, 0.0079]
         
         '2D3/2-2K13/2';... % [0, 0, 0.0860]
         '2D3/2-4G9/2';... % [0, 0.0023, 0.0325]
         '2D3/2-4G7/2';... % [0.0206, 0.0418, 0]
         '2D3/2-2G7/2';... % [0.0104, 0.0839, 0]
         '2D3/2-4G5/2';... % [0.0002, 0.0039, 0]
         '2D3/2-2H11/2';... % [0, 0.1078, 0.1807]
         '2D3/2-4F9/2';... % [0, 0.0003, 0.0139]
         '2D3/2-4S3/2';... % [0.0073, 0, 0]
         '2D3/2-4F7/2';... % [0.0025, 0.0001, 0]
         '2D3/2-2H9/2';... % [0, 0.0259, 0.0872]
         '2D3/2-4F5/2';... % [0.0038, 0, 0]
         '2D3/2-4F3/2';... % [0.0050, 0, 0]
         '2D3/2-4I15/2';... % [0, 0, 0.0083]
         '2D3/2-4I13/2';...
         '2D3/2-4I11/2';... % [0, 0.0016, 0.0326]
         '2D3/2-4I9/2';... % [0, 0.0202, 0.0001]
         
         '2K13/2-4G9/2';... % [0.0210, 0.0440, 0.1131]
         '2K13/2-4G7/2';... % [0, 0.5179, 0.0014]
         '2K13/2-2G7/2';... % [0, 0.7062, 0.0012]
         '2K13/2-4G5/2';... % [0, 0.0018, 0.0077]
         '2K13/2-2H11/2';... % [0.0014, 0.0044, 0.4795]
         '2K13/2-4F9/2';... % [0.0462, 0.0042, 0.2931]
         '2K13/2-4S3/2';...
         '2K13/2-4F7/2';... % [0, 0.0664, 0.0003]
         '2K13/2-2H9/2';... % [0.1211, 0.0063, 1.1292]
         '2K13/2-4F5/2';... % [0, 0.0026, 0.0048]
         '2K13/2-4F3/2';... % [0, 0, 0.0076]
         '2K13/2-4I15/2';...
         '2K13/2-4I13/2';... % [0.0032, 0.0001, 0.0024]
         '2K13/2-4I11/2';...
         '2K13/2-4I9/2';... % [0.0071, 0.0002, 0.0330]
         
         '4G9/2-4G7/2';... % [0.0375, 0.1449, 0.1417]
         '4G9/2-2G7/2';... % [0.0730, 0.1395, 0.0034]
         '4G9/2-4G5/2';... % [0, 0.1035, 0.2477]
         '4G9/2-2H11/2';... % [0.0032, 0.0308, 0.2310]
         '4G9/2-4F9/2';... % [0.1181, 0.1593, 0.0207]
         '4G9/2-4S3/2';... % [0, 0.1922, 0.0009]
         '4G9/2-4F7/2';... % [0.5548, 0.0001, 0.0825]
         '4G9/2-2H9/2';... % [0.0390, 0.0478, 0.0982]
         '4G9/2-4F5/2';... % [0.1912, 0.0995, 0.0022]
         '4G9/2-4F3/2';... % [0, 0.0570, 0.1451]
         '4G9/2-4I15/2';... % [0, 0.1426, 0.2398]
         '4G9/2-4I13/2';... % [0.9552, 0.3843, 0.0157]
         '4G9/2-4I11/2';... % [0.1403, 0.3495, 0.0505]
         '4G9/2-4I9/2';... % [0.0044, 0.0584, 0.0383]
         
         '4G7/2-2G7/2';... % [0.0633, 0.0008, 0.0359]
         '4G7/2-4G5/2';...
         '4G7/2-2H11/2';... % [0.0011, 0.0197, 0.1020]
         '4G7/2-4F9/2';... % [0.0006, 0.0112, 0.0099]
         '4G7/2-4S3/2';... % [0.0021, 0.2023, 0]
         '4G7/2-4F7/2';... % [0.1747, 0.0732, 0.0023]
         '4G7/2-2H9/2';... % [0.0508, 0.0543, 0.3685]
         '4G7/2-4F5/2';... % [0.2569, 0.0009, 0.1195]
         '4G7/2-4F3/2';... % [0.1062, 0.0629, 0]
         '4G7/2-4I15/2';... % [0, 0.0273, 0.0045]
         '4G7/2-4I13/2';... % [0, 0.2407, 0.0613]
         '4G7/2-4I11/2';... % [0.6684, 0.1075, 0.0099]
         '4G7/2-4I9/2';... % [0.0596, 0.1709, 0.0566]
         
         '2G7/2-4G5/2';...
         '2G7/2-2H11/2';... % [0.0068, 0, 0.3593]
         '2G7/2-4F9/2';...
         '2G7/2-4S3/2';... % [0.0006, 0.0731, 0]
         '2G7/2-4F7/2';... % [0.1267, 0.0589, 0.0104]
         '2G7/2-2H9/2';... % [0.0088, 0.0292, 0.1989]
         '2G7/2-4F5/2';... % [0.2504, 0.0075, 0.0750]
         '2G7/2-4F3/2';... % [0.0735, 0.0400, 0]
         '2G7/2-4I15/2';... % [0, 0.0010, 0.1064]
         '2G7/2-4I13/2';... % [0, 0.0875, 0.0345]
         '2G7/2-4I11/2';... % [0.3996, 0.1764, 0.0522]
         '2G7/2-4I9/2';... % [0.0707, 0.1720, 0.0274]
         
         '4G5/2-2H11/2';... % [0, 0.0002, 0.0145]
         '4G5/2-4F9/2';... % [0.0026, 0.0070, 0.1303]
         '4G5/2-4S3/2';... % [0.0007, 0.1775, 0]
         '4G5/2-4F7/2';... % [0.0382, 0.1047, 0.1626]
         '4G5/2-2H9/2';... % [0.0012, 0.0134, 0.0018]
         '4G5/2-4F5/2';... % [0.2671, 0.1301, 0]
         '4G5/2-4F3/2';... % [0.4856, 0.0433, 0]
         '4G5/2-4I15/2';... % [0, 0, 0.0046]
         '4G5/2-4I13/2';... % [0, 0.0018, 0.0077]
         '4G5/2-4I11/2';... % [0, 0.2867, 0.0961]
         '4G5/2-4I9/2';... % [0.8975, 0.4126, 0.0346]
         
         '2H11/2-4F9/2';... % [0.0873, 0.0239, 0.0172]
         '2H11/2-4S3/2';... % [0, 0.0563, 0.0016]
         '2H11/2-4F7/2';... % [0.0336, 0.0154, 0.1287]
         '2H11/2-2H9/2';... % [0.0687, 0.0037, 0.2755]
         '2H11/2-4F5/2';... % [0, 0.0030, 0.0239]
         '2H11/2-4F3/2';... % [0, 0.0001, 0.0081]
         '2H11/2-4I15/2';... % [0.1293, 0.0687, 0]
         '2H11/2-4I13/2';... % [0.0043, 0.0168, 0.0029]
         '2H11/2-4I11/2';... % [0.0043, 0.0094, 0.0062]
         '2H11/2-4I9/2';... % [0, 0.0027, 0.0104]
         
         '4F9/2-4S3/2';... % [0, 0.0023, 0.0011]
         '4F9/2-4F7/2';... % [0.0934, 0.0912, 0.0783]
         '4F9/2-2H9/2';... % [0.0487, 0.0029, 0.0018]
         '4F9/2-4F5/2';... % [0.0105, 0.0508, 0.1091]
         '4F9/2-4F3/2';... % [0, 0.0046, 0.1115]
         '4F9/2-4I15/2';... % [0, 0.5, 0.4628]
         '4F9/2-4I13/2';... % [0.0029, 0.2148, 0.5102]
         '4F9/2-4I11/2';... % [0.0001, 0.0328, 0.3702]
         '4F9/2-4I9/2';... % [0.0009, 0.0092, 0.0406]
         
         '4S3/2-4F7/2';...
         '4S3/2-2H9/2';... % [0, 0.0044, 0.0001]
         '4S3/2-4F5/2';...
         '4S3/2-4F3/2';...
         '4S3/2-4I15/2';... % [0, 0, 0.3306]
         '4S3/2-4I13/2';... % [0, 0, 0.3295]
         '4S3/2-4I11/2';... % [0, 0, 0.2099]
         '4S3/2-4I9/2';... % [0, 0.0025, 0.2347]
         
         '4F7/2-2H9/2';... % [0.0056, 0.0344, 0.0040]
         '4F7/2-4F5/2';... % [0.0655, 0.0540, 0.0872]
         '4F7/2-4F3/2';... % [0.0063, 0.0800, 0]
         '4F7/2-4I15/2';... % [0, 0.1553, 0.6166]
         '4F7/2-4I13/2';... % [0, 0.3314, 0.0001]
         '4F7/2-4I11/2';... % [0.0009, 0.2335, 0.3076]
         '4F7/2-4I9/2';... % [0.0011, 0.0406, 0.4272]
         
         '2H9/2-4F5/2';... % [0.0062, 0.0308, 0.0052]
         '2H9/2-4F3/2';... % [0, 0.0149, 0.0223]
         '2H9/2-4I15/2';... % [0, 0.2155, 0.0775]
         '2H9/2-4I13/2';... % [0.0389, 0.0064, 0.1217]
         '2H9/2-4I11/2';... % [0.0028, 0.0004, 0.0254]
         '2H9/2-4I9/2';... % [0.0095, 0.0082, 0.1195]
         
         '4F5/2-4F3/2';... % [0.0773, 0, 0]
         '4F5/2-4I15/2';... % [0, 0, 0.2300]
         '4F5/2-4I13/2';... % [0, 0.1817, 0.4010]
         '4F5/2-4I11/2';... % [0, 0.1698, 0.0369]
         '4F5/2-4I9/2';... % [0.0006, 0.2337, 0.3983]
         
         '4F3/2-4I15/2';... % [0, 0, 0.0280]
         '4F3/2-4I13/2';... % [0, 0, 0.2093]
         '4F3/2-4I11/2';... % [0, 0.1423, 0.4083]
         '4F3/2-4I9/2';... % [0, 0.2283, 0.0554]
         
         '4I15/2-4I13/2';... % [0.0195, 0.1187, 1.4522]
         '4I15/2-4I11/2';... % [0, 0.0109, 0.4180]
         '4I15/2-4I9/2';... % [0, 0, 0.0452]
         
         '4I13/2-4I11/2';... % [0.0256, 0.1352, 1. 2376]
         '4I13/2-4I9/2';... % [0, 0.0135, 0.4549]
         
         '4I11/2-4I9/2'}; % [0.0194, 0.1072, 1.1639]
s = [0.0260, 0,           0;...
          0, 0,      0.4889;...
          0, 0.0314, 0.0006;...
     0.1744, 0.0011,      0;...
          0, 0.0033, 0.1828;...
          0, 0.0077, 0.0064;...
     0.0003, 0.0481, 0.0558;...
     0.0064, 0.0688, 0.1756;...
     0.0014, 0.0008,      0;...
          0, 0.2523, 0.0184;...
     0.0003, 0.0110, 0.0132;...
     0.0071,      0,      0;...
     0.0005, 0.0171, 0.0064;...
     0.0078, 0.1994, 0.0791;...
     0.0005, 0.0006,      0;...
     0.0009, 0.0007,      0;...
          0,      0,      0;...
          0, 0.0037, 0.0169;...
          0, 0.0001, 0.0029;...
          0, 0.0002, 0.0017;...
     ...
          0,      0,      0;...
          0,      0,      0;...
     0.0291,      0,      0;...
          0,      0,      0;...
          0, 0.0010,      0;...
          0, 0.0026,      0;...
          0, 0.0097,      0;...
     0.0346,      0,      0;...
          0,      0,      0;...
          0, 0.0033,      0;...
     0.0175,      0,      0;...
          0, 0.0200,      0;...
          0, 0.0871,      0;...
     0.0101,      0,      0;...
     0.0131,      0,      0;...
          0,      0,      0;...
          0,      0, 0.1746;...
          0,      0, 0.1643;...
          0, 0.0396,      0;...
     ...
     0.0099, 0.0162, 0.0912;...
          0,      0, 0.3482;...
          0,      0,      0;...
          0, 0.1408, 0.0246;...
          0, 0.0186, 0.0018;...
          0, 0.0383, 0.0122;...
          0,      0, 0.0051;...
     0.1556, 0.0017, 1.5224;...
          0, 0.0003, 0.2037;...
          0,      0, 0.0030;...
          0,      0, 0.0077;...
          0, 0.4675, 0.4145;...
          0,      0, 0.0051;...
          0,      0, 0.0099;...
          0,      0,      0;...
          0,      0,      0;...
     0.0020, 0.0003, 0.0039;...
          0, 0.0052, 0.0149;...
     ...
          0, 0.0300, 0.0003;...
     0.0001, 0.0077, 0.0233;...
     0.0521, 0.5102, 0.1206;...
     0.0023, 0.0341, 0.3811;...
     0.0119, 0.1233, 0.0015;...
          0, 0.0094, 0.0914;...
     0.0009, 0.0809, 0.0109;...
     0.9423, 0.2060, 0.0411;...
          0, 0.3245, 0.0004;...
     0.1729, 0.1623, 0.1447;...
     0.1796, 0.0001, 0.0037;...
          0, 0.0611, 0.1976;...
          0, 0.0015, 0.0992;...
     1.5301, 0.8915, 0.1590;...
     0.1283, 0.3514, 0.1609;...
     0.0044, 0.0645, 0.0563;...
          0, 0.0052, 0.0079;...
     ...
          0,      0, 0.0860;...
          0, 0.0023, 0.0325;...
     0.0206, 0.0418,      0;...
     0.0104, 0.0839,      0;...
     0.0002, 0.0039,      0;...
          0, 0.1078, 0.1807;...
          0, 0.0003, 0.0139;...
     0.0073,      0,      0;...
     0.0025, 0.0001,      0;...
          0, 0.0259, 0.0872;...
     0.0038,      0,      0;...
     0.0050,      0,      0;...
          0,      0, 0.0083;...
          0,      0,      0;...
          0, 0.0016, 0.0326;...
          0, 0.0202, 0.0001;...
     ...
     0.0210, 0.0440, 0.1131;...
          0, 0.5179, 0.0014;...
          0, 0.7062, 0.0012;...
          0, 0.0018, 0.0077;...
     0.0014, 0.0044, 0.4795;...
     0.0462, 0.0042, 0.2931;...
          0,      0,      0;...
          0, 0.0664, 0.0003;...
     0.1211, 0.0063, 1.1292;...
          0, 0.0026, 0.0048;...
          0,      0, 0.0076;...
          0,      0,      0;...
     0.0032, 0.0001, 0.0024;...
          0,      0,      0;...
     0.0071, 0.0002, 0.0330;...
     ...
     0.0375, 0.1449, 0.1417;...
     0.0730, 0.1395, 0.0034;...
          0, 0.1035, 0.2477;...
     0.0032, 0.0308, 0.2310;...
     0.1181, 0.1593, 0.0207;...
          0, 0.1922, 0.0009;...
     0.5548, 0.0001, 0.0825;...
     0.0390, 0.0478, 0.0982;...
     0.1912, 0.0995, 0.0022;...
          0, 0.0570, 0.1451;...
          0, 0.1426, 0.2398;...
     0.9552, 0.3843, 0.0157;...
     0.1403, 0.3495, 0.0505;...
     0.0044, 0.0584, 0.0383;...
     ...
     0.0633, 0.0008, 0.0359;...
          0,      0,      0;...
     0.0011, 0.0197, 0.1020;...
     0.0006, 0.0112, 0.0099;...
     0.0021, 0.2023,      0;...
     0.1747, 0.0732, 0.0023;...
     0.0508, 0.0543, 0.3685;...
     0.2569, 0.0009, 0.1195;...
     0.1062, 0.0629,      0;...
          0, 0.0273, 0.0045;...
          0, 0.2407, 0.0613;...
     0.6684, 0.1075, 0.0099;...
     0.0596, 0.1709, 0.0566;...
     ...
          0,      0,      0;...
     0.0068,      0, 0.3593;...
          0,      0,      0;...
     0.0006, 0.0731,      0;...
     0.1267, 0.0589, 0.0104;...
     0.0088, 0.0292, 0.1989;...
     0.2504, 0.0075, 0.0750;...
     0.0735, 0.0400,      0;...
          0, 0.0010, 0.1064;...
          0, 0.0875, 0.0345;...
     0.3996, 0.1764, 0.0522;...
     0.0707, 0.1720, 0.0274;...
     ...
          0, 0.0002, 0.0145;...
     0.0026, 0.0070, 0.1303;...
     0.0007, 0.1775,      0;...
     0.0382, 0.1047, 0.1626;...
     0.0012, 0.0134, 0.0018;...
     0.2671, 0.1301,      0;...
     0.4856, 0.0433,      0;...
          0,      0, 0.0046;...
          0, 0.0018, 0.0077;...
          0, 0.2867, 0.0961;...
     0.8975, 0.4126, 0.0346;...
     ...
     0.0873, 0.0239, 0.0172;...
          0, 0.0563, 0.0016;...
     0.0336, 0.0154, 0.1287;...
     0.0687, 0.0037, 0.2755;...
          0, 0.0030, 0.0239;...
          0, 0.0001, 0.0081;...
     0.1293, 0.0687,      0;...
     0.0043, 0.0168, 0.0029;...
     0.0043, 0.0094, 0.0062;...
          0, 0.0027, 0.0104;...
     ...
          0, 0.0023, 0.0011;...
     0.0934, 0.0912, 0.0783;...
     0.0487, 0.0029, 0.0018;...
     0.0105, 0.0508, 0.1091;...
          0, 0.0046, 0.1115;...
          0, 0.5000, 0.4628;...
     0.0029, 0.2148, 0.5102;...
     0.0001, 0.0328, 0.3702;...
     0.0009, 0.0092, 0.0406;...
     ...
          0,      0,      0;...
          0, 0.0044, 0.0001;...
          0,      0,      0;...
          0,      0,      0;...
          0,      0, 0.3306;...
          0,      0, 0.3295;...
          0,      0, 0.2099;...
          0, 0.0025, 0.2347;...
     ...
     0.0056, 0.0344, 0.0040;...
     0.0655, 0.0540, 0.0872;...
     0.0063, 0.0800,      0;...
          0, 0.1553, 0.6166;...
          0, 0.3314, 0.0001;...
     0.0009, 0.2335, 0.3076;...
     0.0011, 0.0406, 0.4272;...
     ...
     0.0062, 0.0308, 0.0052;...
          0, 0.0149, 0.0223;...
          0, 0.2155, 0.0775;...
     0.0389, 0.0064, 0.1217;...
     0.0028, 0.0004, 0.0254;...
     0.0095, 0.0082, 0.1195;...
     ...
     0.0773,      0,      0;...
          0,      0, 0.2300;...
          0, 0.1817, 0.4010;...
          0, 0.1698, 0.0369;...
     0.0006, 0.2337, 0.3983;...
     ...
          0,      0, 0.0280;...
          0,      0, 0.2093;...
          0, 0.1423, 0.4083;...
          0, 0.2283, 0.0554;...
     ...
     0.0195, 0.1187, 1.4522;...
          0, 0.0109, 0.4180;...
          0,      0, 0.0452;...
     ...
     0.0256, 0.1352, 1.2376;...
          0, 0.0135, 0.4549;...
     ...
     0.0194, 0.1072, 1.1639];

% electric dipole
s1 = s(:,1);
s2 = s(:,2);
s3 = s(:,3);

% magnetic dipole
% I don't know how to obtain its data, so I set it to zero.
s4 = zeros(size(s1));

save('JO_neodymium.mat','layere','energy','num','layerM','raree','layer','s1','s2','s3','s4');